!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.piano=e():t.piano=e()}(this,function(){return function(t){function e(i){if(n[i])return n[i].exports;var o=n[i]={exports:{},id:i,loaded:!1};return t[i].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e,n,i){t.style["-webkit-transform"]="scale("+e+")",t.style["-moz-transform"]="scale("+e+")",t.style["-ms-transform"]="scale("+e+")",t.style["-o-transform"]="scale("+e+")",t.style.transform="scale("+e+")",t.style["-webkit-transform-origin"]=n+" "+i,t.style["-moz-transform-origin"]=n+" "+i,t.style["-ms-transform-origin"]=n+" "+i,t.style["-o-transform-origin"]=n+" "+i,t.style["transform-origin"]=n+" "+i}function o(t,e,n,i){return t.slice(0,e)+(i||"")+t.slice(e+n)}function s(t,e){t.pianoEnhancedEvents.forEach(function(t){t.forEach(function(t){(t.target.dataset&&t.target.dataset.pianoKey||e)&&t.target.removeEventListener(t.eventName,t.eventHandler)})}),t.pianoEnhancedEvents=[]}function a(t,e,n,i,o){e.pianoEnhancedEvents&&e.pianoEnhancedEvents.length>-1?e.pianoEnhancedEvents.push([]):(e.pianoEnhancedEvents=[],e.pianoEnhancedEvents.push([])),n=n instanceof Array?n:[n],n.forEach(function(n){e.pianoEnhancedEvents[e.pianoEnhancedEvents.length-1].push({eventName:n,target:i,eventHandler:function(e){e.timeStamp!==t.lastTimeStamp&&o(e),t.lastTimeStamp=e.timeStamp}})}),e.pianoEnhancedEvents[e.pianoEnhancedEvents.length-1].forEach(function(t){t.target.addEventListener(t.eventName,t.eventHandler)})}function r(t,e,n){var i;return function(){var o=this,s=arguments,a=function(){i=null,n||t.apply(o,s)},r=n&&!i;clearTimeout(i),i=setTimeout(a,e||200),r&&t.apply(o,s)}}var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},u=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),d=function(){function t(e){var i=this;if(n(this,t),document.querySelectorAll("#piano").length)return console.warn("piano is already initialized, not creating."),!1;if(this.defaults={triggerEvents:["click"],slideContent:!1,slideContainer:"body",onBeforeHidden:function(){},onHidden:function(){},layouts:e.layouts||[],autohide:!0,autoScroll:!0},this.pianoEnhancedEvents=[],this.pianoInstance=[],this.settings=c(this.defaults,e),this.container=c(document.createElement("div"),{id:"piano",className:"piano-container animated"}),this.detectInputs(),document.body.appendChild(this.container),this.settings.autohide){var o=function(t){var e=t.target.dataset||{};""===e.piano||i.container.contains(t.target)||i.hideKeyboard()};a(this,document,this.defaults.triggerEvents,document,o)}}return u(t,[{key:"createKeyboard",value:function(t,e,n){var i=this,o=c({},t);delete o.pianoInstance,delete o.triggers,delete o.layouts;var s=e.dataset,r={};o.shift=!1,s.pianoPosition?s.pianoPosition.indexOf("absolute")>-1?r.position=s.pianoPosition.replace(/absolute,\s/gi,"").split(","):r.position=s.pianoPosition?s.pianoPosition.split(","):[]:r.position=[],r.layout=s.pianoLayout,r.limit=s.pianoLimit,r.animationIn=s.pianoAnimationIn,r.animationOut=s.pianoAnimationOut,r.scale=s.pianoScale,n&&(r=c(r,n));var l=s.pianoEventId,u=null;l&&(u=document.createEvent("Event"),u.initEvent(l,!0,!0)),o.settings={position:{x:r.position[0]||"center",y:r.position[1]||"bottom"},layout:r.layout||"default",limit:r.limit||-1,submitEvent:u,animationIn:r.animationIn||"fadeInUp",animationOut:r.animationOut||"fadeOutDown",scale:r.scale||1};var d=function(t){i.clearKeyboards(o,i),i.currentTarget=t.target,i.displayKeyboard(o),t.preventDefault()};a(this,o,this.defaults.triggerEvents,e,d),this.pianoInstance.push(o)}},{key:"detectInputs",value:function(){this.triggers=document.querySelectorAll("[data-piano]");for(var t=this.triggers.length,e=0;e<t;e++)this.createKeyboard(this,this.triggers[e])}},{key:"addTarget",value:function(t,e){this.createKeyboard(this,t,e)}},{key:"displayKeyboard",value:function(t){var e=this;e.currentKeyboard=t;var n=document.createElement("div");n.className="piano-rows";var o=this.settings.layouts[t.settings.layout],s=[];s.push(document.createElement("ul"));for(var c in o){var u=document.createElement("li");if("break"===o[c][0])n.appendChild(s[s.length-1]),s.push(document.createElement("ul"));else{var d=document.createElement("button");"object"===l(o[c][0])?(u.className=o[c][0].name,d.className="key "+o[c][0].name,d.innerHTML=o[c][0].value,d.dataset.pianoKey=o[c][0].name):(d.className="key "+o[c],d.textContent=o[c][0],d.dataset.pianoKey=o[c][0]),a(this,e,e.settings.triggerEvents,d,function(t){r(this.keyPressed(t),300,!1)}.bind(this)),u.appendChild(d)}n.appendChild(s[s.length-1]),s[s.length-1].appendChild(u),this.currentTarget.focus()}isNaN(t.settings.position.x)||isNaN(t.settings.position.y)?(this.container.className+=" "+t.settings.position.x,this.container.className+=" "+t.settings.position.y):(this.container.style.left=t.settings.position.x+"px",this.container.style.top=t.settings.position.y+"px"),this.container.style.display="block",this.container.classList.remove(this.currentKeyboard.settings.animationOut),this.container.appendChild(n),this.container.classList.add(this.currentKeyboard.settings.animationIn);var h=e.currentKeyboard.settings.scale;if(h>1){var p=e.currentKeyboard.settings.position.x,f=e.currentKeyboard.settings.position.y;i(n,h,p,f)}document.body.classList.add("piano-open"),this.settings.autoScroll&&this.scrollWindow(),this.settings.slideContent&&(document.querySelector(this.settings.slideContainer).style.top="-"+n.getBoundingClientRect().height/2+"px")}},{key:"keyPressed",value:function(t){var e=t.target,n=e.textContent,i=this.currentTarget,s=i.selectionStart,a=i.selectionEnd,r=a-s||1,l=t.target.innerText.length,c=this.currentKeyboard.settings.limit,u=this.currentKeyboard.settings.submitEvent;if(/del/i.test(e.className)){var d=s?-1:0;i.value=o(i.value,s+d,r,""),l=-1}else/space/i.test(e.className)?(i.value.length<=c||c===-1)&&(i.value=o(i.value,s,r-1," ")):/shift/i.test(e.className)?this.switchCase():/larr/i.test(e.className)?l=-1:/rarr/i.test(e.className)?l=1:/hide/i.test(e.className)?this.hideKeyboard():/submit/i.test(e.className)?u?i.dispatchEvent(u):console.warn("You did not provide a data-piano-event-id attribute."):(i.value.length<=c||c===-1)&&(i.value=o(i.value,s,r-1,n));if(i.selectionStart=s+l,i.selectionEnd=s+l,document.createEvent){var h=document.createEvent("HTMLEvents");h.initEvent("input",!1,!0),i.dispatchEvent(h)}else i.fireEvent("input");i.focus(),t.preventDefault()}},{key:"scrollWindow",value:function(){var t=this.currentTarget.getBoundingClientRect().top-100,e=window.scrollY+t;t>0&&this.scrollTo(e,300)}},{key:"scrollTo",value:function(t,e){var n=this;if(!(e<=0)){var i=t-window.scrollY,o=i/e*10;setTimeout(function(){window.scrollTo(0,window.scrollY+o),window.scrollY!==t&&n.scrollTo(t,e-10)},10)}}},{key:"switchCase",value:function(){for(var t=this.currentKeyboard.shift=!this.currentKeyboard.shift,e=document.querySelectorAll(".piano-rows > ul > li"),n=this.settings.layouts[this.currentKeyboard.settings.layout],i=e.length,o=0;o<i;o++){var s=e[o].children[0];if(s){var a=s.textContent;n[o].length>1&&n[o][0].length>0?s.textContent=t?n[o][1]:n[o][0]:s.textContent=t?a.toUpperCase():a.toLowerCase()}}}},{key:"hideKeyboard",value:function(){var t=this;"block"===this.container.style.display&&("function"==typeof this.settings.onBeforeHidden&&this.settings.onBeforeHidden(),this.container.classList.remove(this.currentKeyboard.settings.animationIn),this.container.classList.add(this.currentKeyboard.settings.animationOut),setTimeout(function(){t.container.style.display="none","function"==typeof t.settings.onHidden&&t.settings.onHidden()},1e3*this.container.style.animationDuration||300),document.body.classList.remove("piano-open"),this.settings.slideContent&&(document.querySelector(this.settings.slideContainer).style.top=0))}},{key:"clearKeyboards",value:function(t,e,n){s(t,n),this.container&&this.container.firstChild&&(this.container.firstChild.remove(),this.container.style.top=this.container.style.left="",this.container.className="piano-container animated",this.currentKeyboard=null,document.body.classList.remove("piano-open"),this.settings.slideContent&&(document.querySelector(this.settings.slideContainer).style.top=0))}},{key:"isOpen",value:function(){return null!==document.body.className.match(/\piano-open\b/)}},{key:"destroy",value:function(){var t=this;return this.pianoInstance&&this.pianoInstance.forEach(function(e){t.clearKeyboards(e,t)}),document.pianoEnhancedEvents&&document.pianoEnhancedEvents.forEach(function(t){t.forEach(function(t){t.target.removeEventListener(t.event,t.eventHandler)})}),this.container&&this.container.remove(),this.defaults=null,this.pianoEnhancedEvents=null,this.pianoInstance=null,this.settings=null,this.container=null,null}}]),t}();t.exports=d}])});
//# sourceMappingURL=piano.min.js.map
